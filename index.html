<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RoboBala - Sterowanie</title>
    <link rel="stylesheet" href="css/style_new.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
</head>
<body class="theme-dark">
    <!-- Splash Screen -->
    <div id="splashScreen" class="splash-screen active">
        <div class="splash-content">
            <div class="splash-logo">ü§ñ</div>
            <h1 class="splash-title">RoboBala</h1>
            <p class="splash-subtitle">Panel Sterowania</p>
            <div class="splash-spinner"></div>
        </div>
    </div>

    <!-- Emergency FAB -->
    <button id="emergencyFab" class="fab-emergency" title="Awaryjne zatrzymanie robota">
        <span class="fab-icon">‚èπ</span>
        <span class="fab-text">STOP</span>
    </button>

    <!-- Sticky Header -->
    <header class="app-header">
        <button id="menuToggle" class="menu-toggle" aria-label="Otw√≥rz menu">
            <span></span>
            <span></span>
            <span></span>
        </button>
        <h1 class="app-title">RoboBala</h1>
        <div class="header-status">
            <span class="status-dot" id="connectionDot"></span>
            <span class="status-text" id="connectionText">Roz≈ÇƒÖczony</span>
        </div>
    </header>

    <!-- Off-Canvas Sidebar -->
    <nav id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <h2>Menu</h2>
            <button id="sidebarClose" class="sidebar-close" aria-label="Zamknij menu">&times;</button>
        </div>
        <ul class="sidebar-menu">
            <li><a href="#" data-view="dashboard" class="active">
                <span class="menu-icon">üéõÔ∏è</span>
                <span>Pulpit Sterowniczy</span>
            </a></li>
            <li><a href="#" data-view="pid-tuning">
                <span class="menu-icon">‚öôÔ∏è</span>
                <span>Strojenie PID</span>
            </a></li>
            <li><a href="#" data-view="calibration">
                <span class="menu-icon">üéØ</span>
                <span>Kalibracja</span>
            </a></li>
            <li><a href="#" data-view="autonomous">
                <span class="menu-icon">ü§ñ</span>
                <span>Sterowanie Autonomiczne</span>
            </a></li>
            <li><a href="#" data-view="autotuning">
                <span class="menu-icon">üéØ</span>
                <span>Auto-strojenie PID</span>
            </a></li>
            <li><a href="#" data-view="diagnostics">
                <span class="menu-icon">üîç</span>
                <span>Diagnostyka</span>
            </a></li>
            <li><a href="#" data-view="settings">
                <span class="menu-icon">‚ö°</span>
                <span>Ustawienia</span>
            </a></li>
        </ul>
        <div class="sidebar-footer">
            <button id="themeToggle" class="theme-toggle">
                <span class="theme-icon">üåô</span>
                <span class="theme-label">Tryb Ciemny</span>
            </button>
        </div>
    </nav>

    <!-- Sidebar Overlay -->
    <div id="sidebarOverlay" class="sidebar-overlay"></div>

    <!-- Main Content -->
    <main class="app-content">
        <!-- Dashboard View (Default) -->
        <section id="viewDashboard" class="view active">
            <!-- Connection Card -->
            <div class="card">
                <button id="connectBtn" class="btn btn-primary btn-large">
                    <span>Po≈ÇƒÖcz z Robotem</span>
                </button>
            </div>

            <!-- Virtual Joystick -->
            <div class="card joystick-card">
                <h2 class="card-title">Sterowanie
                    <span class="tooltip-icon" data-tooltip="U≈ºywaj joysticka do kontroli ruchu robota. Prz√≥d/ty≈Ç kontroluje prƒôdko≈õƒá, lewo/prawo obr√≥t.">?</span>
                </h2>
                <div id="joystickContainer" class="joystick-container">
                    <canvas id="joystickCanvas"></canvas>
                </div>
            </div>

            <!-- Main Toggles -->
            <div class="card">
                <h2 class="card-title">Tryby Pracy</h2>
                <div class="toggle-group">
                    <div class="toggle-item">
                        <label for="balanceToggle" class="toggle-label">
                            <span>Balansowanie</span>
                            <span class="tooltip-icon" data-tooltip="W≈ÇƒÖcz, aby robot aktywnie utrzymywa≈Ç r√≥wnowagƒô pionowƒÖ.">?</span>
                        </label>
                        <label class="switch">
                            <input type="checkbox" id="balanceToggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="toggle-item">
                        <label for="holdPositionToggle" class="toggle-label">
                            <span>Trzymaj Pozycjƒô</span>
                            <span class="tooltip-icon" data-tooltip="Robot bƒôdzie pr√≥bowa≈Ç pozostaƒá w miejscu, korygujƒÖc dryf.">?</span>
                        </label>
                        <label class="switch">
                            <input type="checkbox" id="holdPositionToggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="toggle-item">
                        <label for="speedModeToggle" class="toggle-label">
                            <span>Tryb Prƒôdko≈õci</span>
                            <span class="tooltip-icon" data-tooltip="W≈ÇƒÖcz kontrolƒô prƒôdko≈õci zamiast kontroli kƒÖta pochylenia.">?</span>
                        </label>
                        <label class="switch">
                            <input type="checkbox" id="speedModeToggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Telemetry -->
            <div class="card">
                <h2 class="card-title">Telemetria</h2>
                <div class="telemetry-grid">
                    <div class="telemetry-item">
                        <span class="telemetry-label">Pitch</span>
                        <span class="telemetry-value" id="pitchValue">0.0¬∞</span>
                    </div>
                    <div class="telemetry-item">
                        <span class="telemetry-label">Roll</span>
                        <span class="telemetry-value" id="rollValue">0.0¬∞</span>
                    </div>
                    <div class="telemetry-item">
                        <span class="telemetry-label">Yaw</span>
                        <span class="telemetry-value" id="yawValue">0.0¬∞</span>
                    </div>
                    <div class="telemetry-item">
                        <span class="telemetry-label">Czas Pƒôtli</span>
                        <span class="telemetry-value" id="loopTimeValue">0 Œºs</span>
                    </div>
                </div>
            </div>

            <!-- 3D Visualization -->
            <div class="card">
                <h2 class="card-title">Model 3D
                    <span class="tooltip-icon" data-tooltip="Wizualizacja orientacji robota w czasie rzeczywistym.">?</span>
                </h2>
                <div id="robot3DContainer" class="robot-3d-container"></div>
                <div class="button-group">
                    <button id="reset3DView" class="btn btn-secondary btn-small">Resetuj Widok</button>
                    <button id="toggle3DAnimation" class="btn btn-secondary btn-small">W≈Ç./Wy≈Ç. Animacjƒô</button>
                </div>
            </div>
        </section>

        <!-- PID Tuning View -->
        <section id="viewPidTuning" class="view">
            <div class="card">
                <h2 class="card-title">Strojenie PID</h2>
                
                <!-- PID Tabs -->
                <div class="tabs">
                    <button class="tab active" data-tab="balance">Balans</button>
                    <button class="tab" data-tab="speed">Prƒôdko≈õƒá</button>
                    <button class="tab" data-tab="position">Pozycja</button>
                    <button class="tab" data-tab="rotation">Obr√≥t</button>
                    <button class="tab" data-tab="heading">Kurs</button>
                </div>

                <!-- Balance PID Tab -->
                <div id="tabBalance" class="tab-content active">
                    <div class="accordion">
                        <button class="accordion-btn">Nastawy Podstawowe</button>
                        <div class="accordion-content">
                            <div class="param-group">
                                <label for="balanceKp">
                                    Kp - Si≈Ça
                                    <span class="tooltip-icon" data-tooltip="Okre≈õla, jak mocno robot reaguje na bie≈ºƒÖcy b≈ÇƒÖd przechy≈Çu. Zbyt du≈ºa warto≈õƒá powoduje oscylacje.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="balanceKp" value="95" min="0" max="500" step="0.1">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                            <div class="param-group">
                                <label for="balanceKi">
                                    Ki - Korekta
                                    <span class="tooltip-icon" data-tooltip="Eliminuje d≈Çugotrwa≈Çy, sta≈Çy b≈ÇƒÖd. Czƒôsto nie jest potrzebny dla balansu.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="balanceKi" value="0" min="0" max="10" step="0.01">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                            <div class="param-group">
                                <label for="balanceKd">
                                    Kd - T≈Çumienie
                                    <span class="tooltip-icon" data-tooltip="Dzia≈Ça jak amortyzator - przeciwdzia≈Ça szybkim zmianom kƒÖta i wyg≈Çadza ruch.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="balanceKd" value="3.23" min="0" max="50" step="0.01">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="accordion">
                        <button class="accordion-btn">Ustawienia Zaawansowane</button>
                        <div class="accordion-content">
                            <div class="param-group">
                                <label for="balanceFilterAlpha">
                                    Filtr Pochodnej (%)
                                    <span class="tooltip-icon" data-tooltip="Wyg≈Çadza sygna≈Ç r√≥≈ºniczkujƒÖcy (Kd), redukujƒÖc wp≈Çyw szum√≥w z czujnika.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="balanceFilterAlpha" value="100" min="1" max="100" step="1">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                            <div class="param-group">
                                <label for="balanceIntegralLimit">
                                    Limit Integratora
                                    <span class="tooltip-icon" data-tooltip="Maksymalna warto≈õƒá, jakƒÖ mo≈ºe osiƒÖgnƒÖƒá suma ca≈ÇkujƒÖca (Ki).">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="balanceIntegralLimit" value="50" min="0" max="200" step="1">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Speed PID Tab -->
                <div id="tabSpeed" class="tab-content">
                    <div class="accordion">
                        <button class="accordion-btn">Nastawy Podstawowe</button>
                        <div class="accordion-content">
                            <div class="param-group">
                                <label for="speedKp">
                                    Kp - Reakcja
                                    <span class="tooltip-icon" data-tooltip="Kontroluje, jak mocno robot pochyla siƒô, aby osiƒÖgnƒÖƒá zadanƒÖ prƒôdko≈õƒá. Wy≈ºsza warto≈õƒá = szybsze przyspieszanie/zwalnianie, ale mo≈ºe powodowaƒá oscylacje prƒôdko≈õci. Zacznij od ma≈Çych warto≈õci (0.1-0.5) i zwiƒôkszaj stopniowo. Typowy zakres: 0.1-2.0.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="speedKp" value="0.0" min="0" max="10" step="0.01">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                            <div class="param-group">
                                <label for="speedKi">
                                    Ki - Eliminacja b≈Çƒôdu
                                    <span class="tooltip-icon" data-tooltip="Eliminuje sta≈Çy b≈ÇƒÖd prƒôdko≈õci (gdy robot jedzie ciƒÖgle trochƒô wolniej/szybciej ni≈º powinien). Czƒôsto wystarczy 0, ale je≈õli prƒôdko≈õƒá nie osiƒÖga docelowej warto≈õci, dodaj ma≈ÇƒÖ warto≈õƒá Ki (0.01-0.1). Zbyt wysoka warto≈õƒá powoduje oscylacje. Typowy zakres: 0-0.2.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="speedKi" value="0.0" min="0" max="1" step="0.001">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                            <div class="param-group">
                                <label for="speedKd">
                                    Kd - T≈Çumienie
                                    <span class="tooltip-icon" data-tooltip="Wyg≈Çadza zmiany prƒôdko≈õci, przeciwdzia≈Ça oscylacjom. Pomaga, gdy robot 'skacze' miƒôdzy r√≥≈ºnymi prƒôdko≈õciami. Zacznij od 0, dodaj (0.01-0.1) je≈õli prƒôdko≈õƒá oscyluje. Zbyt wysoka warto≈õƒá spowalnia reakcjƒô na zmiany. Typowy zakres: 0-0.5.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="speedKd" value="0.0" min="0" max="5" step="0.001">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                            <div class="param-group">
                                <label for="maxTargetAngle">
                                    Max. kƒÖt z PID Prƒôdko≈õci (st.)
                                    <span class="tooltip-icon" data-tooltip="Maksymalny kƒÖt, jaki PID prƒôdko≈õci mo≈ºe zadaƒá robotowi, aby osiƒÖgnƒÖƒá docelowƒÖ prƒôdko≈õƒá. Limit bezpiecze≈Ñstwa - zapobiega zbyt du≈ºemu pochyleniu. Wiƒôksza warto≈õƒá = szybsze przyspieszanie, ale wiƒôksze ryzyko upadku. Typowy zakres: 10-20¬∞.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="maxTargetAngle" value="15.0" min="1" max="45" step="0.5">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                            <div class="param-group">
                                <label for="speedDeadband">
                                    Strefa martwa (imp/s)
                                    <span class="tooltip-icon" data-tooltip="Je≈õli rzeczywista prƒôdko≈õƒá r√≥≈ºni siƒô od zadanej o mniej ni≈º ta warto≈õƒá, PID nie reaguje. Zapobiega ciƒÖg≈Çym mikro-korektom przy ma≈Çych b≈Çƒôdach, oszczƒôdza energiƒô i zmniejsza drgania. Typowy zakres: 3-15 imp/s.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="speedDeadband" value="5" min="0" max="50" step="1">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                            <div class="param-group">
                                <label for="speedIntegralLimit">
                                    Limit Integratora
                                    <span class="tooltip-icon" data-tooltip="Maksymalna warto≈õƒá sumy ca≈ÇkujƒÖcej (Ki). Zapobiega 'wind-up' (rozregulowaniu) integratora. Istotne tylko gdy u≈ºywasz Ki > 0. Typowy zakres: 10-50.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="speedIntegralLimit" value="20" min="0" max="100" step="1">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="accordion">
                        <button class="accordion-btn">Ustawienia Zaawansowane</button>
                        <div class="accordion-content">
                            <div class="param-group">
                                <label for="speedFilterAlpha">
                                    Filtr Pochodnej (%)
                                    <span class="tooltip-icon" data-tooltip="Wyg≈Çadza sygna≈Ç r√≥≈ºniczkujƒÖcy (Kd). 100% = brak filtrowania. Zmniejsz, je≈õli Kd wprowadza nerwowo≈õƒá. Typowy zakres: 60-90%.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="speedFilterAlpha" value="80" min="1" max="100" step="1">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="sign-toggle-group">
                        <label>Znak sprzƒô≈ºenia (Prƒôdko≈õƒá)</label>
                        <div id="speedSign" class="sign-toggle">
                            <button data-sign="1" class="active">+1</button>
                            <button data-sign="-1">-1</button>
                        </div>
                        <span class="sign-tooltip" data-tooltip="Odwr√≥ƒá znak sprzƒô≈ºenia pƒôtli prƒôdko≈õci (zmiana mo≈ºliwa tylko w trybie IDLE)">?</span>
                    </div>
                </div>

                <!-- Position PID Tab -->
                <div id="tabPosition" class="tab-content">
                    <div class="accordion">
                        <button class="accordion-btn">Nastawy Podstawowe</button>
                        <div class="accordion-content">
                            <div class="param-group">
                                <label for="positionKp">
                                    Kp - Si≈Ça powrotu
                                    <span class="tooltip-icon" data-tooltip="Kontroluje, jak mocno robot dƒÖ≈ºy do powrotu do zadanej pozycji (funkcja 'trzymaj pozycjƒô'). Wy≈ºsza warto≈õƒá = silniejsza korekta, szybszy powr√≥t. Zbyt wysoka powoduje oscylacje wok√≥≈Ç pozycji docelowej. Zacznij od 0.5-2.0. Typowy zakres: 0.5-5.0.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="positionKp" value="0.0" min="0" max="20" step="0.1">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                            <div class="param-group">
                                <label for="positionKi">
                                    Ki - Korekta
                                    <span class="tooltip-icon" data-tooltip="Usuwa sta≈Çe odchylenie od pozycji (gdy robot powoli 'dryfuje' mimo w≈ÇƒÖczonej funkcji trzymania pozycji). Czƒôsto nie jest potrzebny. Dodaj ma≈ÇƒÖ warto≈õƒá (0.001-0.01) tylko je≈õli robot systematycznie odje≈ºd≈ºa od pozycji. Typowy zakres: 0-0.05.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="positionKi" value="0.0" min="0" max="1" step="0.001">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                            <div class="param-group">
                                <label for="positionKd">
                                    Kd - Hamowanie
                                    <span class="tooltip-icon" data-tooltip="Hamuje ruch, gdy robot zbli≈ºa siƒô do pozycji docelowej - zapobiega 'przestrzeleniu'. Wy≈ºsza warto≈õƒá = p≈Çynniejsze, bardziej kontrolowane zatrzymanie, ale wolniejszy powr√≥t. Zacznij od 0.1-0.5. Typowy zakres: 0.1-2.0.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="positionKd" value="0.0" min="0" max="10" step="0.05">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                            <div class="param-group">
                                <label for="maxTargetSpeed">
                                    Max. prƒôdko≈õƒá z PID Pozycji (imp/s)
                                    <span class="tooltip-icon" data-tooltip="Maksymalna prƒôdko≈õƒá, jakƒÖ PID pozycji mo≈ºe zadaƒá podczas powrotu do punktu. Limit bezpiecze≈Ñstwa - zapobiega zbyt szybkiemu ruchowi przy du≈ºych odchyleniach. Wy≈ºsza warto≈õƒá = szybszy powr√≥t, ale wiƒôksze ryzyko przesterowania. Typowy zakres: 500-1500 imp/s.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="maxTargetSpeed" value="1000" min="100" max="4000" step="50">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                            <div class="param-group">
                                <label for="positionDeadband">
                                    Margines b≈Çƒôdu (imp.)
                                    <span class="tooltip-icon" data-tooltip="Je≈õli odchylenie od pozycji jest mniejsze ni≈º ta warto≈õƒá (w impulsach enkodera), PID pozycji nie reaguje. Robot 'akceptuje' to ma≈Çe odchylenie i nie pr√≥buje go korygowaƒá. Zapobiega ciƒÖg≈Çym mikro-ruchom. Typowy zakres: 10-30 imp.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="positionDeadband" value="15" min="0" max="100" step="1">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                            <div class="param-group">
                                <label for="positionIntegralLimit">
                                    Limit Integratora
                                    <span class="tooltip-icon" data-tooltip="Maksymalna warto≈õƒá sumy ca≈ÇkujƒÖcej (Ki). Zapobiega 'wind-up' integratora. Istotne tylko gdy Ki > 0. Typowy zakres: 50-200.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="positionIntegralLimit" value="100" min="0" max="500" step="10">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="accordion">
                        <button class="accordion-btn">Ustawienia Zaawansowane</button>
                        <div class="accordion-content">
                            <div class="param-group">
                                <label for="positionFilterAlpha">
                                    Filtr Pochodnej (%)
                                    <span class="tooltip-icon" data-tooltip="Wyg≈Çadza sygna≈Ç r√≥≈ºniczkujƒÖcy (Kd). 100% = brak filtrowania. Zmniejsz do 70-90%, je≈õli hamowanie jest 'szarpane'. Typowy zakres: 70-95%.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="positionFilterAlpha" value="90" min="1" max="100" step="1">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="sign-toggle-group">
                        <label>Znak sprzƒô≈ºenia (Pozycja)</label>
                        <div id="positionSign" class="sign-toggle">
                            <button data-sign="1" class="active">+1</button>
                            <button data-sign="-1">-1</button>
                        </div>
                        <span class="sign-tooltip" data-tooltip="Odwr√≥ƒá znak sprzƒô≈ºenia pƒôtli pozycji (zmiana mo≈ºliwa tylko w trybie IDLE)">?</span>
                    </div>
                </div>

                <!-- Rotation PID Tab -->
                <div id="tabRotation" class="tab-content">
                    <div class="accordion">
                        <button class="accordion-btn">Nastawy Podstawowe</button>
                        <div class="accordion-content">
                            <div class="param-group">
                                <label for="rotationKp">
                                    Kp - Si≈Ça obrotu
                                    <span class="tooltip-icon" data-tooltip="Kontroluje moc obrotu podczas automatycznego skrƒôtu o zadany kƒÖt. Wy≈ºsza warto≈õƒá = szybszy obr√≥t, ale ryzyko przesterowania (robot obraca siƒô za daleko). Zacznij od ma≈Çych warto≈õci (1-5) i zwiƒôkszaj stopniowo. Typowy zakres: 2-10.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="rotationKp" value="0.0" min="0" max="50" step="0.1">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                            <div class="param-group">
                                <label for="rotationKd">
                                    Kd - T≈Çumienie
                                    <span class="tooltip-icon" data-tooltip="Hamuje obr√≥t, gdy robot zbli≈ºa siƒô do docelowego kƒÖta. Zapobiega oscylacjom wok√≥≈Ç pozycji docelowej. Wy≈ºsza warto≈õƒá = p≈Çynniejsze, bardziej kontrolowane zatrzymanie. Zacznij od 0.5-2.0. Typowy zakres: 0.5-5.0.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="rotationKd" value="0.0" min="0" max="20" step="0.1">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Heading PID Tab -->
                <div id="tabHeading" class="tab-content">
                    <div class="accordion">
                        <button class="accordion-btn">Nastawy Podstawowe</button>
                        <div class="accordion-content">
                            <div class="param-group">
                                <label for="headingKp">
                                    Kp - Si≈Ça korekty
                                    <span class="tooltip-icon" data-tooltip="Kontroluje, jak mocno robot koryguje odchylenie od zadanego kursu podczas jazdy prosto. Wy≈ºsza warto≈õƒá = mocniejsza korekta, robot jedzie bardziej 'po linii'. Zbyt wysoka mo≈ºe powodowaƒá 'zygzakowanie'. Zacznij od 0.5-2.0. Typowy zakres: 0.5-5.0.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="headingKp" value="0.0" min="0" max="10" step="0.05">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                            <div class="param-group">
                                <label for="headingKi">
                                    Ki - Precyzja
                                    <span class="tooltip-icon" data-tooltip="Usuwa systematyczne odchylenie kursu (gdy robot powoli 'skrƒôca' w jednƒÖ stronƒô mimo jazdy prosto). Dodaj ma≈ÇƒÖ warto≈õƒá (0.01-0.1) je≈õli robot ma tendencjƒô do odbijania w bok. Typowy zakres: 0-0.2.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="headingKi" value="0.0" min="0" max="1" step="0.005">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                            <div class="param-group">
                                <label for="headingKd">
                                    Kd - T≈Çumienie
                                    <span class="tooltip-icon" data-tooltip="Wyg≈Çadza korekty kursu, zapobiega 'szarpaniu' przy zmianach kierunku. Przydatne je≈õli robot nerwowo koryguje kurs. Zacznij od 0.05-0.2. Typowy zakres: 0.05-0.5.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="headingKd" value="0.0" min="0" max="5" step="0.01">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                            <div class="param-group">
                                <label for="rotationToPwmScale">
                                    Skala wyj≈õcia PID -> PWM
                                    <span class="tooltip-icon" data-tooltip="Konwertuje wyj≈õcie PID obrotu/kursu na komponent skrƒôtu (PWM). Zwiƒôksz je≈õli korekty kierunku sƒÖ za s≈Çabe, zmniejsz je≈õli robot 'przeostrza' lub oscyluje. Typowy zakres: 0.005 - 0.05.">?</span>
                                </label>
                                <div class="input-group">
                                    <button class="btn-minus">‚àí</button>
                                    <input type="number" id="rotationToPwmScale" value="0.01" min="0" max="1" step="0.001">
                                    <button class="btn-plus">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sign-toggle-group">
                        <label>Znak sprzƒô≈ºenia (Balans)</label>
                        <div id="balanceSign" class="sign-toggle">
                            <button data-sign="1" class="active">+1</button>
                            <button data-sign="-1">-1</button>
                        </div>
                        <span class="sign-tooltip" data-tooltip="Odwr√≥ƒá znak sprzƒô≈ºenia pƒôtli balansu (zmiana mo≈ºliwa tylko w trybie IDLE)">?</span>
                    </div>
                <div class="button-group mt-3">
                    <button id="loadConfig" class="btn btn-secondary">Wczytaj z Robota</button>
                    <button id="saveConfig" class="btn btn-primary">Zapisz na Robocie</button>
                </div>

                <!-- Tuning Progress Panel -->
                <div id="tuning-progress-panel" class="card" style="display: none;">
                    <h3 class="card-title">Postƒôp Strojenia</h3>
                    <div class="progress-info">
                        <div class="progress-item">
                            <span class="progress-label">Metoda:</span>
                            <span class="progress-value" id="current-method">---</span>
                        </div>
                        <div class="progress-item">
                            <span class="progress-label">Iteracja:</span>
                            <span class="progress-value" id="current-iteration">0</span> / <span id="total-iterations">0</span>
                        </div>
                        <div class="progress-item">
                            <span class="progress-label">Najlepszy Fitness:</span>
                            <span class="progress-value" id="best-fitness">---</span>
                        </div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill" style="width: 0%;"></div>
                    </div>
                    <div class="button-group">
                        <button id="pause-tuning" class="btn btn-warning">Pauza</button>
                        <button id="resume-tuning" class="btn btn-success" style="display: none;">Wzn√≥w</button>
                        <button id="stop-tuning" class="btn btn-danger">Zatrzymaj</button>
                    </div>
                </div>

                <!-- Best Parameters Display -->
                <div id="best-params-panel" class="card" style="display: none;">
                    <h3 class="card-title">Najlepsze Parametry</h3>
                    <div class="param-display">
                        <div class="param-item">
                            <span class="param-label">Kp:</span>
                            <span class="param-value" id="best-kp">---</span>
                        </div>
                        <div class="param-item">
                            <span class="param-label">Ki:</span>
                            <span class="param-value" id="best-ki">---</span>
                        </div>
                        <div class="param-item">
                            <span class="param-label">Kd:</span>
                            <span class="param-value" id="best-kd">---</span>
                        </div>
                    </div>
                    <div class="button-group">
                        <button id="apply-best-btn" class="btn btn-primary" disabled>Zastosuj Parametry</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Other Views (Calibration, Autonomous, Diagnostics, Settings) -->
        <section id="viewCalibration" class="view">
            <div class="card">
                <h2 class="card-title">Kalibracja</h2>
                <p class="info-text">Narzƒôdzia kalibracji bƒôdƒÖ dostƒôpne tutaj...</p>
            </div>
        </section>

        <section id="viewAutonomous" class="view">
            <div class="card">
                <h2 class="card-title">Sterowanie Autonomiczne</h2>
                
                <!-- Sequence Controls -->
                <div class="sequence-controls">
                    <div class="button-group">
                        <button id="add-sequence-step-btn" class="btn btn-secondary">Dodaj Krok</button>
                        <button id="run-sequence-btn" class="btn btn-primary">Uruchom Sekwencjƒô</button>
                        <button id="stop-sequence-btn" class="btn btn-danger" style="display: none;">Zatrzymaj</button>
                        <button id="clear-sequence-btn" class="btn btn-warning">Wyczy≈õƒá</button>
                    </div>
                </div>

                <!-- Sequence List -->
                <div class="sequence-list" id="sequence-list">
                    <!-- Sequence steps will be added here dynamically -->
                </div>

                <!-- Path Visualization -->
                <div class="card">
                    <h2 class="card-title">Wizualizacja ≈öcie≈ºki</h2>
                    <div id="path-visualization-container" class="path-visualization-container">
                        <canvas id="pathCanvas"></canvas>
                    </div>
                    <div class="button-group">
                        <button id="reset-path-btn" class="btn btn-secondary">Resetuj ≈öcie≈ºkƒô</button>
                    </div>
                </div>
            </div>
        </section>

        <section id="viewAutotuning" class="view">
            <div class="card">
                <h2 class="card-title">Auto-strojenie PID</h2>
                
                <!-- Tuning Configuration -->
                <div class="tuning-config">
                    <div class="config-section">
                        <label for="tuning-loop-selector">üéØ Pƒôtla PID do strojenia:</label>
                        <select id="tuning-loop-selector">
                            <option value="balance">Pƒôtla Balansu</option>
                            <option value="speed">Pƒôtla Prƒôdko≈õci</option>
                            <option value="position">Pƒôtla Pozycji</option>
                        </select>
                        <button id="open-fitness-modal-btn">Konfiguruj Wagi</button>
                    </div>
                    
                    <div class="config-section">
                        <h4>üîç Przestrze≈Ñ Przeszukiwania</h4>
                        <div class="search-space-grid">
                            <div class="search-space-param">
                                <label for="search-kp-min">Kp Min:</label>
                                <input type="number" id="search-kp-min" value="40" step="0.1">
                            </div>
                            <div class="search-space-param">
                                <label for="search-kp-max">Kp Max:</label>
                                <input type="number" id="search-kp-max" value="50" step="0.1">
                            </div>
                            <div class="search-space-param">
                                <label for="search-ki-min">Ki Min:</label>
                                <input type="number" id="search-ki-min" value="0" step="0.01">
                            </div>
                            <div class="search-space-param">
                                <label for="search-ki-max">Ki Max:</label>
                                <input type="number" id="search-ki-max" value="0" step="0.01">
                            </div>
                            <div class="search-space-param">
                                <label for="search-kd-min">Kd Min:</label>
                                <input type="number" id="search-kd-min" value="0" step="0.01">
                            </div>
                            <div class="search-space-param">
                                <label for="search-kd-max">Kd Max:</label>
                                <input type="number" id="search-kd-max" value="5" step="0.01">
                            </div>
                        </div>
                    </div>
                    
                    <div class="config-section">
                        <h4>üß™ Parametry Testu</h4>
                        <label><input type="checkbox" id="test-with-impulse" checked> Test z impulsem (skok odpowiedzi)</label>
                        <label><input type="checkbox" id="include-ki-checkbox"> Uwzglƒôdnij strojenie Ki</label>
                    </div>
                </div>

                <!-- Tuning Methods Tabs -->
                <div class="tuning-methods">
                    <div class="method-tabs">
                        <button class="method-tab active" data-method="ga">üß¨ Algorytm Genetyczny</button>
                        <button class="method-tab" data-method="pso">üåÄ PSO</button>
                        <button class="method-tab" data-method="zn">üìä Ziegler-Nichols</button>
                    </div>
                    
                    <div class="method-content active" data-method="ga">
                        <div class="method-config">
                            <div><label for="ga-population">Rozmiar populacji:</label><input type="number" id="ga-population" value="10" min="5" max="100"></div>
                            <div><label for="ga-generations">Liczba pokole≈Ñ:</label><input type="number" id="ga-generations" value="10" min="5" max="100"></div>
                            <div><label for="ga-mutation">Wska≈∫nik mutacji (%):</label><input type="number" id="ga-mutation" value="10" min="0" max="100" step="1"></div>
                            <div><label for="ga-crossover">Wska≈∫nik krzy≈ºowania (%):</label><input type="number" id="ga-crossover" value="70" min="0" max="100" step="1"></div>
                            <div><label><input type="checkbox" id="ga-elitism" checked> Elitaryzm</label></div>
                        </div>
                    </div>
                    
                    <div class="method-content" data-method="pso">
                        <div class="method-config">
                            <div><label for="pso-particles">Liczba czƒÖstek:</label><input type="number" id="pso-particles" value="10" min="10" max="100"></div>
                            <div><label for="pso-iterations">Liczba iteracji:</label><input type="number" id="pso-iterations" value="10" min="10" max="100"></div>
                            <div><label for="pso-inertia">Waga bezw≈Çadno≈õci:</label><input type="number" id="pso-inertia" value="0.7" min="0" max="1" step="0.01"></div>
                            <div><label for="pso-cognitive">Waga poznawcza:</label><input type="number" id="pso-cognitive" value="1.5" min="0" max="3" step="0.1"></div>
                            <div><label for="pso-social">Waga spo≈Çeczna:</label><input type="number" id="pso-social" value="1.5" min="0" max="3" step="0.1"></div>
                        </div>
                    </div>
                    
                    <div class="method-content" data-method="zn">
                        <div class="method-config">
                            <div><label for="zn-amplitude">Amplituda przeka≈∫nika:</label><input type="number" id="zn-amplitude" value="2.0" min="0.5" max="10" step="0.5"></div>
                            <div><label for="zn-min-cycles">Minimalna liczba cykli:</label><input type="number" id="zn-min-cycles" value="3" min="2" max="10"></div>
                        </div>
                    </div>
                </div>

                <!-- Tuning Progress Panel -->
                <div id="tuning-progress-panel" class="card" style="display: none;">
                    <h3>üìä Postƒôp Optymalizacji</h3>
                    <div class="progress-info">
                        <div>Status: <span id="tuning-status-text">Oczekuje</span></div>
                        <div>Iteracja: <span id="current-iteration">0</span> / <span id="total-iterations">0</span></div>
                        <div>Pokolenie: <span id="current-generation">0</span> / <span id="ga-gen-total">0</span></div>
                        <div>Osobnik: <span id="current-individual">0</span> / <span id="population-size">0</span></div>
                        <div>Parametry: Kp: <span id="current-kp">---</span> Ki: <span id="current-ki">---</span> Kd: <span id="current-kd">---</span></div>
                        <div>Fitness: <span id="current-fitness">---</span></div>
                    </div>
                    <canvas id="current-telemetry-chart" height="80"></canvas>
                    <div id="fitness-chart-container"><canvas id="fitness-chart"></canvas></div>
                    
                    <div class="current-best">
                        <h4>üèÜ Najlepsze Znalezione Parametry</h4>
                        <div class="current-best-grid">
                            <div><strong>Kp:</strong> <span id="best-kp">---</span></div>
                            <div><strong>Ki:</strong> <span id="best-ki">---</span></div>
                            <div><strong>Kd:</strong> <span id="best-kd">---</span></div>
                            <div><strong>Fitness:</strong> <span id="best-fitness">---</span></div>
                        </div>
                        <button id="apply-best-btn" disabled>Zastosuj Najlepsze</button>
                    </div>
                    
                    <div class="recent-results">
                        <h4>üïí Ostatnie 5 pr√≥b</h4>
                        <div id="recent-results-list">Brak danych.</div>
                        <button id="open-tuning-history-btn">üìú Historia i Eksport</button>
                    </div>
                </div>

                <!-- Tuning Controls -->
                <div class="tuning-controls">
                    <button id="start-tuning-btn">üöÄ Rozpocznij Strojenie</button>
                    <button id="pause-tuning-btn" disabled>‚è∏Ô∏è Pauza</button>
                    <button id="resume-tuning-btn" style="display:none;" disabled>‚ñ∂Ô∏è Wzn√≥w</button>
                    <button id="stop-tuning-btn" disabled>‚èπÔ∏è Zatrzymaj</button>
                </div>
            </div>
        </section>
            <div class="card">
                <h2 class="card-title">Diagnostyka</h2>
                
                <!-- Signal Analyzer -->
                <div class="signal-analyzer">
                    <h3>Wykres Sygna≈Ç√≥w</h3>
                    <div class="chart-controls" id="signalChartControls">
                        <!-- Checkboxes will be added here dynamically -->
                    </div>
                    <canvas id="signalAnalyzerChart"></canvas>
                    <div class="button-group">
                        <button id="pauseChartBtn" class="btn btn-secondary">Pauza</button>
                        <button id="resumeChartBtn" class="btn btn-secondary" style="display: none;">Wzn√≥w</button>
                        <button id="exportCsvBtn" class="btn btn-primary">Eksport CSV</button>
                        <button id="exportRangeCsvBtn" class="btn btn-primary">Eksport Zakresu CSV</button>
                        <button id="resetZoomBtn" class="btn btn-secondary">Reset Zoom</button>
                        <button id="exportPngBtn" class="btn btn-primary">Eksport PNG</button>
                    </div>
                </div>

                <!-- Cursor Info -->
                <div class="cursor-info" id="cursorInfo" style="display: none;">
                    <div class="cursor-row">
                        <div class="cursor-item">
                            <span class="cursor-label">Kursor A:</span>
                            <span class="cursor-value" id="cursorAX">---</span>
                            <span class="cursor-value" id="cursorAY">---</span>
                        </div>
                        <div class="cursor-item">
                            <span class="cursor-label">Kursor B:</span>
                            <span class="cursor-value" id="cursorBX">---</span>
                            <span class="cursor-value" id="cursorBY">---</span>
                        </div>
                    </div>
                    <div class="cursor-row">
                        <div class="cursor-item">
                            <span class="cursor-label">ŒîT:</span>
                            <span class="cursor-value" id="cursorDeltaT">---</span>
                        </div>
                        <div class="cursor-item">
                            <span class="cursor-label">ŒîPitch:</span>
                            <span class="cursor-value" id="cursorDeltaYPitch">---</span>
                        </div>
                        <div class="cursor-item">
                            <span class="cursor-label">ŒîSpeed:</span>
                            <span class="cursor-value" id="cursorDeltaYSpeed">---</span>
                        </div>
                    </div>
                    <div class="button-group">
                        <button id="cursorABBtn" class="btn btn-secondary">Kursory A/B</button>
                    </div>
                </div>

                <!-- Results Table -->
                <div class="results-table-container">
                    <h3>Wyniki Test√≥w</h3>
                    <table id="results-table">
                        <thead>
                            <tr>
                                <th>Test #</th>
                                <th>Kp</th>
                                <th>Ki</th>
                                <th>Kd</th>
                                <th>Fitness</th>
                                <th>ITAE</th>
                                <th>Overshoot</th>
                                <th>Akcje</th>
                            </tr>
                        </thead>
                        <tbody id="results-table-body">
                            <!-- Results will be added here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="viewSettings" class="view">
            <div class="card">
                <h2 class="card-title">Ustawienia</h2>
                
                <!-- Joystick Settings -->
                <div class="accordion">
                    <button class="accordion-btn">Strojenie Joysticka</button>
                    <div class="accordion-content">
                        <div class="param-group">
                            <label for="joystickSensitivityInput">Czu≈Ço≈õƒá Globalna (%)
                                <span class="tooltip-icon" data-tooltip="Globalny mno≈ºnik dla wszystkich warto≈õci z joysticka. Ustawienie 100% oznacza pe≈ÇnƒÖ czu≈Ço≈õƒá - robot reaguje maksymalnie na ruchy joysticka. Zmniejsz do 50-70%, je≈õli robot jest zbyt nerwowy lub reaguje zbyt gwa≈Çtownie. Przydatne podczas nauki sterowania lub w ciasnych przestrzeniach. Typowy zakres: 60-100%.">?</span>
                            </label>
                            <div class="input-group">
                                <button class="btn-minus">‚àí</button>
                                <input type="number" id="joystickSensitivityInput" value="100" min="10" max="100" step="5">
                                <button class="btn-plus">+</button>
                            </div>
                        </div>
                        <div class="param-group">
                            <label for="expoJoystickInput">Expo Joysticka (%)
                                <span class="tooltip-icon" data-tooltip="Krzywa wyk≈Çadnicza (expo) zmienia charakterystykƒô odpowiedzi joysticka. Przy 0% odpowied≈∫ jest liniowa. Zwiƒôkszenie warto≈õci sprawia, ≈ºe przy ma≈Çych wychyleniach robot reaguje ≈Çagodniej (wiƒôksza precyzja), a przy du≈ºych wychyleniach normalnie. Warto≈õƒá 30-50% zapewnia dobrƒÖ r√≥wnowagƒô miƒôdzy precyzjƒÖ a responsywno≈õciƒÖ. Typowy zakres: 0-50%.">?</span>
                            </label>
                            <div class="input-group">
                                <button class="btn-minus">‚àí</button>
                                <input type="number" id="expoJoystickInput" value="0" min="0" max="90" step="1">
                                <button class="btn-plus">+</button>
                            </div>
                        </div>
                        <div class="param-group">
                            <label for="maxSpeedJoystickInput">Max. prƒôdko≈õƒá (imp/s)
                                <span class="tooltip-icon" data-tooltip="Maksymalna prƒôdko≈õƒá zadana w trybie prƒôdko≈õci przy pe≈Çnym wychyleniu joysticka do przodu/ty≈Çu. Wy≈ºsza warto≈õƒá = szybszy robot. Dla bezpiecznej nauki zacznij od 500-800 imp/s. Dla sportowej jazdy mo≈ºesz zwiƒôkszyƒá do 1500-2500 imp/s. Uwaga: zbyt wysoka warto≈õƒá mo≈ºe powodowaƒá utratƒô balansu! Typowy zakres: 500-1500 imp/s.">?</span>
                            </label>
                            <div class="input-group">
                                <button class="btn-minus">‚àí</button>
                                <input type="number" id="maxSpeedJoystickInput" value="800" min="200" max="4000" step="100">
                                <button class="btn-plus">+</button>
                            </div>
                        </div>
                        <div class="param-group">
                            <label for="joystickAngleSensitivityInput">Czu≈Ço≈õƒá KƒÖta (st.)
                                <span class="tooltip-icon" data-tooltip="Maksymalny kƒÖt pochylenia zadany w trybie kƒÖta przy pe≈Çnym wychyleniu joysticka. Mniejsza warto≈õƒá (5-8¬∞) = ≈Çagodniejsze przyspieszenie, bardziej przewidywalne zachowanie. Wiƒôksza warto≈õƒá (12-20¬∞) = agresywniejsze przyspieszenie, szybsza reakcja. Rozpocznij od 8-10¬∞ i dostosuj do swoich preferencji. Typowy zakres: 6-15¬∞.">?</span>
                            </label>
                            <div class="input-group">
                                <button class="btn-minus">‚àí</button>
                                <input type="number" id="joystickAngleSensitivityInput" value="10" min="1" max="30" step="0.5">
                                <button class="btn-plus">+</button>
                            </div>
                        </div>
                        <div class="param-group">
                            <label for="turnFactorInput">Czu≈Ço≈õƒá Skrƒôtu (%)
                                <span class="tooltip-icon" data-tooltip="Kontroluje, jak szybko robot obraca siƒô w miejscu przy wychyleniu joysticka w poziomie. Mniejsza warto≈õƒá (15-25%) = powolne, p≈Çynne skrƒôty. Wiƒôksza warto≈õƒá (40-60%) = szybkie, ostre skrƒôty. Za wysoka warto≈õƒá mo≈ºe powodowaƒá utratƒô balansu podczas obrotu. Typowy zakres: 20-40%.">?</span>
                            </label>
                            <div class="input-group">
                                <button class="btn-minus">‚àí</button>
                                <input type="number" id="turnFactorInput" value="25" min="0" max="100" step="5">
                                <button class="btn-plus">+</button>
                            </div>
                        </div>
                        <div class="param-group">
                            <label for="joystickDeadzoneInput">Strefa Martwa (%)
                                <span class="tooltip-icon" data-tooltip="Obszar wok√≥≈Ç ≈õrodka joysticka, w kt√≥rym ruch jest ignorowany. Przydatne, je≈õli joystick 'dryfuje' sam z siebie lub chcesz uniknƒÖƒá przypadkowych mikroruch√≥w. Warto≈õƒá 5-10% usuwa drobne dr≈ºenia bez utraty czu≈Ço≈õci. Typowy zakres: 0-15%.">?</span>
                            </label>
                            <div class="input-group">
                                <button class="btn-minus">‚àí</button>
                                <input type="number" id="joystickDeadzoneInput" value="0" min="0" max="50" step="1">
                                <button class="btn-plus">+</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Joystick Mapping -->
                <div class="accordion">
                    <button class="accordion-btn">Mapowanie Joysticka</button>
                    <div class="accordion-content">
                        <div class="joystick-mapping">
                            <div class="mapping-section">
                                <h4>Przyciski Akcji</h4>
                                <div class="mapping-grid" id="button-mapping-grid">
                                    <!-- Button mappings will be populated by JavaScript -->
                                </div>
                            </div>
                            <div class="mapping-section">
                                <h4>Osie Sterowania</h4>
                                <div class="axis-mapping">
                                    <div class="axis-item">
                                        <label>O≈õ X (Lewo/Prawo):</label>
                                        <select id="axis-x-select">
                                            <option value="-1">Brak</option>
                                        </select>
                                    </div>
                                    <div class="axis-item">
                                        <label>O≈õ Y (Prz√≥d/Ty≈Ç):</label>
                                        <select id="axis-y-select">
                                            <option value="-1">Brak</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="mapping-controls">
                                <button id="start-mapping-btn" class="btn btn-primary">Rozpocznij Mapowanie</button>
                                <button id="save-mapping-btn" class="btn btn-secondary">Zapisz Mapowanie</button>
                                <button id="load-mapping-btn" class="btn btn-secondary">Wczytaj Mapowanie</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Hardware Settings -->
                <div class="accordion">
                    <button class="accordion-btn">Parametry Sprzƒôtowe</button>
                    <div class="accordion-content">
                        <div class="param-group">
                            <label for="wheelDiameterInput">≈örednica Ko≈Ça (cm)
                                <span class="tooltip-icon" data-tooltip="≈örednica ko≈Ça robota w centymetrach. Parametr kluczowy dla obliczania prƒôdko≈õci i pokonanego dystansu. Zmierz dok≈Çadnie ≈õrednicƒô od krawƒôdzi do krawƒôdzi przez ≈õrodek ko≈Ça. Wiƒôksze ko≈Ça = wiƒôksza prƒôdko≈õƒá przy tych samych obrotach silnika. Typowy zakres: 6-12 cm.">?</span>
                            </label>
                            <div class="input-group">
                                <button class="btn-minus">‚àí</button>
                                <input type="number" id="wheelDiameterInput" value="8.2" min="1" max="30" step="0.1">
                                <button class="btn-plus">+</button>
                            </div>
                        </div>
                        <div class="param-group">
                            <label for="trackWidthInput">Rozstaw K√≥≈Ç (cm)
                                <span class="tooltip-icon" data-tooltip="Odleg≈Ço≈õƒá miƒôdzy ≈õrodkami obu k√≥≈Ç (szeroko≈õƒá toru). Wp≈Çywa na obliczenia obrotu - szerszy rozstaw wymaga wiƒôkszej r√≥≈ºnicy prƒôdko≈õci k√≥≈Ç do wykonania tego samego skrƒôtu. Zmierz odleg≈Ço≈õƒá miƒôdzy ≈õrodkami osi k√≥≈Ç. Typowy zakres: 10-20 cm.">?</span>
                            </label>
                            <div class="input-group">
                                <button class="btn-minus">‚àí</button>
                                <input type="number" id="trackWidthInput" value="12.5" min="5" max="50" step="0.1">
                                <button class="btn-plus">+</button>
                            </div>
                        </div>
                        <div class="param-group">
                            <label for="encoderPprInput">Impulsy na Obr√≥t (PPR)
                                <span class="tooltip-icon" data-tooltip="Liczba impuls√≥w enkodera na jeden pe≈Çny obr√≥t ko≈Ça. Zale≈ºy od rozdzielczo≈õci enkodera i przek≈Çadni (je≈õli jest). Warto≈õƒá ta wp≈Çywa na dok≈Çadno≈õƒá pomiaru prƒôdko≈õci i pozycji. Wy≈ºsza warto≈õƒá = wiƒôksza precyzja. Sprawd≈∫ specyfikacjƒô swojego enkodera i przek≈Çadni. Typowy zakres: 300-2000 PPR.">?</span>
                            </label>
                            <div class="input-group">
                                <button class="btn-minus">‚àí</button>
                                <input type="number" id="encoderPprInput" value="820" min="100" max="5000" step="10">
                                <button class="btn-plus">+</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Collapsible Log Sheet -->
    <div id="logSheet" class="log-sheet">
        <div class="log-header" id="logHeader">
            <div class="log-title-area">
                <h3 class="log-title">Logi Systemowe</h3>
                <span class="log-badge" id="logBadge">0</span>
            </div>
            <div class="log-controls">
                <label class="log-autoscroll">
                    <input type="checkbox" id="logAutoscroll" checked>
                    <span>Auto-scroll</span>
                </label>
                <button id="clearLogs" class="btn-icon" title="Wyczy≈õƒá logi">üóëÔ∏è</button>
                <button id="logToggle" class="btn-icon log-toggle-icon" aria-label="Rozwi≈Ñ/zwi≈Ñ logi">
                    <span class="chevron">‚ñ≤</span>
                </button>
            </div>
        </div>
        <div class="log-content" id="logContent">
            <div id="logMessages"></div>
        </div>
    </div>

    <!-- Load Scripts -->
    <script src="js/main.js"></script>
</body>
</html>
